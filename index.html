<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Husband Upgrade Audit üíç</title>
<style>
  :root{
    --bg1:#070815; --bg2:#2a0f58;
    --card: rgba(255,255,255,.92);
    --ink:#111226; --muted: rgba(17,18,38,.70);
    --pink:#ff4f8b; --pink2:#ff86b7; --mint:#37f2c8;
    --line: rgba(17,18,38,.10);
    --shadow: 0 22px 80px rgba(0,0,0,.45);
    --radius: 26px;
  }
  *{box-sizing:border-box}
  body{
    margin:0; min-height:100vh; display:grid; place-items:center;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    background:
      radial-gradient(900px 520px at 18% 18%, rgba(255,79,139,.28), transparent 60%),
      radial-gradient(900px 650px at 82% 26%, rgba(55,242,200,.18), transparent 60%),
      radial-gradient(1200px 760px at 50% 92%, rgba(255,134,183,.13), transparent 60%),
      linear-gradient(135deg, var(--bg1), var(--bg2));
    overflow:hidden;
    color:var(--ink);
  }
  body:before{
    content:""; position:fixed; inset:0; pointer-events:none; opacity:.20; mix-blend-mode:overlay;
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='400' height='400' filter='url(%23n)' opacity='.18'/%3E%3C/svg%3E");
  }
  .wrap{ width:min(980px, 95vw); padding:18px; }
  .card{
    background: var(--card);
    border:1px solid rgba(255,255,255,.30);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow:hidden;
    position:relative;
  }
  .topbar{
    display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    padding: 14px 18px;
    border-bottom: 1px solid var(--line);
    background: rgba(255,255,255,.55);
  }
  .pill{
    padding: 8px 12px; border-radius:999px;
    font-weight: 1000; font-size: 13px;
    background: rgba(255,79,139,.10);
    border: 1px solid rgba(255,79,139,.22);
    color:#b11052;
  }
  .pill2{
    background: rgba(55,242,200,.12);
    border: 1px solid rgba(55,242,200,.22);
    color:#0b5a4f;
  }
  .content{ padding: 22px 22px 18px 22px; }
  h1{
    margin:0 0 10px 0;
    font-size: clamp(26px, 3.2vw, 42px);
    line-height:1.05;
    letter-spacing:-.5px;
  }
  p{
    margin:0 0 14px 0;
    font-size: clamp(15px, 1.8vw, 18px);
    color: var(--muted);
    line-height:1.55;
  }
  .screen{ display:none; }
  .screen.active{ display:block; }

  .panel{
    border-radius: 18px;
    border: 1px solid var(--line);
    background: rgba(255,255,255,.62);
    padding: 14px;
  }
  .label{
    font-weight: 1100;
    font-size: 13px;
    letter-spacing:.2px;
    color: rgba(17,18,38,.78);
    margin-bottom:8px;
  }
  .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
  @media (max-width: 860px){ .grid{ grid-template-columns:1fr; } }

  .buttons{ display:flex; gap:12px; flex-wrap:wrap; margin-top:14px; align-items:center; }
  button{
    border:0; border-radius:999px;
    padding: 14px 18px;
    font-size:16px; font-weight:1100;
    cursor:pointer; user-select:none;
    -webkit-tap-highlight-color: transparent;
    transition: transform .12s ease, filter .12s ease;
  }
  button:active{ transform:scale(.98) }
  .primary{
    background: linear-gradient(135deg, var(--pink), var(--pink2));
    color:white;
    box-shadow: 0 10px 26px rgba(255,79,139,.35);
  }
  .primary:hover{ filter:brightness(1.05) }
  .secondary{
    background: rgba(17,18,38,.07);
    border: 1px solid rgba(17,18,38,.12);
    color: rgba(17,18,38,.86);
  }

  .tiny{ font-size: 13px; color: rgba(17,18,38,.62); }
  .footer{
    padding: 14px 18px 18px 18px;
    display:flex; flex-wrap:wrap;
    gap:10px; align-items:center; justify-content: space-between;
    border-top: 1px solid var(--line);
    background: rgba(255,255,255,.52);
  }

  .bigline{
    font-size: clamp(20px, 3.1vw, 44px);
    font-weight: 1100;
    letter-spacing:-.6px;
    line-height:1.08;
    margin: 0;
    min-height: 1.3em;
    color: rgba(255,255,255,.92);
  }
  .darkStage{
    background:
      linear-gradient(180deg, rgba(0,0,0,.85), rgba(0,0,0,.70)),
      radial-gradient(900px 500px at 50% 60%, rgba(255,255,255,.06), transparent 60%);
    padding: 22px;
    min-height: 420px;
    display:flex;
    align-items:center;
  }
  .darkText{ max-width: 820px; }
  .subline{
    margin-top:14px;
    font-size: clamp(14px, 1.7vw, 18px);
    color: rgba(255,255,255,.76);
    line-height:1.55;
    min-height: 5em;
    white-space: pre-line;
  }
  .hidden{ display:none !important; }

  .meter{
    height: 12px; border-radius:999px;
    background: rgba(17,18,38,.08);
    overflow:hidden;
    border:1px solid rgba(17,18,38,.08);
  }
  .bar{
    height:100%; width:0%;
    background: linear-gradient(90deg, var(--mint), var(--pink2));
    border-radius:999px;
    transition: width .5s ease;
  }
  .warn{
    display:inline-block;
    padding:6px 10px;
    border-radius:999px;
    background: rgba(255,79,139,.10);
    border:1px solid rgba(255,79,139,.22);
    color:#a10e4b;
    font-weight: 1000;
    font-size: 13px;
  }
  .deductions{ margin:0; padding-left:16px; color: rgba(17,18,38,.72); line-height:1.55; font-size:14px; }
  .scoreRow{ display:flex; justify-content:space-between; align-items:center; gap:10px; }
  .scoreBig{ font-size: 34px; font-weight: 1200; letter-spacing:-.6px; }
  .badge{
    padding: 8px 10px;
    border-radius: 999px;
    background: rgba(55,242,200,.12);
    border: 1px solid rgba(55,242,200,.24);
    color:#0b5a4f;
    font-weight: 1100;
    font-size: 13px;
  }
  #musicToggle{
    position:fixed; right:16px; bottom:16px; z-index:9999;
    border:1px solid rgba(255,255,255,.25);
    background:rgba(0,0,0,.35);
    color:white;
    padding:10px 14px;
    border-radius:999px;
    font-weight:900;
    cursor:pointer;
    backdrop-filter: blur(8px);
  }
</style>
</head>
<body>

<audio id="bgm" loop preload="auto">
  <source src="./bp.mp3" type="audio/mpeg">
</audio>
<button id="musicToggle">üîá Music</button>

<div class="wrap">
  <div class="card" id="card">
    <div class="topbar">
      <div class="pill">üíç Where Is My Husband v12.0</div>
      <div class="pill pill2" id="countdownPill">‚è≥ loading‚Ä¶</div>
    </div>

    <!-- S0 -->
    <div class="screen active" id="s0">
      <div class="darkStage">
        <div class="darkText">
          <p class="bigline" id="cold1"></p>
          <p class="bigline" id="cold2" style="margin-top:10px;"></p>
          <div class="subline" id="cold3"></div>

          <div class="buttons" style="margin-top:18px;">
            <button id="coldContinue" class="primary hidden">Continue ‚Üí</button>
          </div>

          <div class="tiny" style="margin-top:10px; color:rgba(255,255,255,.68);">
            Slow-reader mode: ON. Take your time, Shantanu.
          </div>
        </div>
      </div>
    </div>

    <!-- S1 -->
    <div class="screen" id="s1">
      <div class="content">
        <h1 id="h1"></h1>
        <p id="p1"></p>

        <div class="grid">
          <div class="panel">
            <div class="label">Application summary</div>
            <ul class="deductions" id="list1"></ul>
          </div>

          <div class="panel">
            <div class="label">Terms & Conditions</div>
            <div class="panel" style="background:rgba(255,79,139,.09); border:1px solid rgba(255,79,139,.18);">
              <div id="terms" style="font-weight:1000; color: rgba(120,10,55,.92); white-space:pre-line; line-height:1.45;"></div>
            </div>
            <p class="tiny" style="margin-top:10px;">Binding in Dhruva‚Äôs court.</p>
          </div>
        </div>

        <div class="buttons">
          <button id="toAudit" class="primary hidden">I Understand. Continue ‚Üí</button>
        </div>

        <p class="tiny" id="hint1"></p>
      </div>
    </div>

    <!-- S2 -->
    <div class="screen" id="s2">
      <div class="content">
        <h1 id="h2"></h1>
        <p id="p2"></p>

        <div class="panel">
          <div class="label">Audit progress</div>
          <div class="meter"><div class="bar" id="bar"></div></div>
          <div id="log" class="tiny" style="margin-top:10px; white-space:pre-line; line-height:1.55; color: rgba(17,18,38,.78);"></div>
        </div>

        <div class="grid" style="margin-top:14px;">
          <div class="panel">
            <div class="label">Score</div>
            <div class="scoreRow">
              <div class="scoreBig" id="score">100</div>
              <div class="badge" id="badge">Pending</div>
            </div>
            <p class="tiny" id="scoreNote" style="margin-top:8px;"></p>
          </div>

          <div class="panel">
            <div class="label">Deductions log</div>
            <ul class="deductions" id="deduct"><li>‚Äî awaiting findings ‚Äî</li></ul>
          </div>
        </div>

        <div class="panel" style="margin-top:14px;">
          <div class="label">Warnings</div>
          <span class="warn" id="warn">CRITICAL DELAY IN PROPOSAL PIPELINE</span>
          <p class="tiny" id="auditHint" style="margin-top:8px;"></p>
        </div>

        <div class="buttons">
          <button id="toFinal" class="primary hidden">Continue ‚Üí</button>
        </div>
      </div>
    </div>

    <!-- S3 -->
    <div class="screen" id="s3">
      <div class="content">
        <h1 id="h3"></h1>
        <p id="p3"></p>

        <div class="buttons">
          <button id="yes" class="primary">Yes üíò</button>
          <button id="no" class="secondary">No</button>
        </div>

        <div class="panel" style="margin-top:14px;">
          <div class="label">Important note</div>
          <p style="margin:0; color: rgba(17,18,38,.72); line-height:1.5;">
            12 years. Still you. Still my favorite person.
            But respectfully, Shantanu‚Ä¶ another year with <b>NO RING</b> was bold. üíç‚ùå
            Tonight I‚Äôm spoiling you <i>and</i> roasting you. Balance.
          </p>
        </div>
      </div>
    </div>

    <!-- S4 -->
    <div class="screen" id="s4">
      <div class="content">
        <h1>Approved. See you at 7. üíêüíò</h1>
        <p>Good choice, Shantanu. Dhruva knew you were smart.</p>

        <div class="panel">
          <div class="label">Instructions</div>
          <ul class="deductions">
            <li>Be ready at <b>7:00 PM</b></li>
            <li>When the flowers arrive, say ‚Äúthank you babe‚Äù like a proper princess</li>
            <li>Do not ask ‚Äúwhat are we doing‚Äù ‚Äî just show up and be loved</li>
            <li>Negotiations: denied</li>
          </ul>
        </div>

        <div class="tiny" style="margin-top:12px;">‚Äî Dhruva üíÖ</div>
      </div>
    </div>

    <div class="footer">
      <div class="tiny" id="footer">Slow-reader mode is protecting the story.</div>
      <div class="sig">üíò</div>
    </div>
  </div>
</div>

<script>
window.addEventListener("DOMContentLoaded", () => {
  // ---------- Helpers ----------
  const $ = (id) => document.getElementById(id);

  const screens = ["s0","s1","s2","s3","s4"].map($);
  function show(id){
    screens.forEach(s=>s.classList.remove("active"));
    $(id).classList.add("active");
    window.scrollTo(0,0);
  }

  // Safe countdown
  const countdownPill = $("countdownPill");
  function updateCountdown(){
    const now = new Date();
    const target = new Date(now);
    target.setHours(19, 0, 0, 0);
    if (target < now) target.setDate(target.getDate()+1);
    const diff = target - now;
    const h = Math.floor(diff/1000/60/60);
    const m = Math.floor((diff/1000/60)%60);
    const s = Math.floor((diff/1000)%60);
    countdownPill.textContent = `‚è≥ ${h}h ${m}m ${s}s to date o‚Äôclock`;
  }
  setInterval(updateCountdown, 1000);
  updateCountdown();

  // Typewriter (robust)
  const TYPING_SPEED = 22;      // smaller = faster
  const PAUSE = 420;

  function sleep(ms){ return new Promise(r=>setTimeout(r, ms)); }

  async function type(el, text, speed=TYPING_SPEED){
    el.textContent = "";
    for (let i=0;i<text.length;i++){
      el.textContent += text[i];
      await sleep(speed);
    }
  }

  // ---------- Music ----------
  const bgm = $("bgm");
  const musicToggle = $("musicToggle");
  let musicPlaying = false;

  async function startMusic(){
    try{
      await bgm.play();
      bgm.volume = 0.55;
      musicPlaying = true;
      musicToggle.textContent = "üîä Music";
    }catch(e){
      // Ignore ‚Äî user can toggle
    }
  }

  musicToggle.addEventListener("click", async () => {
    try{
      if (!musicPlaying){
        await bgm.play();
        bgm.volume = 0.55;
        musicPlaying = true;
        musicToggle.textContent = "üîä Music";
      }else{
        bgm.pause();
        musicPlaying = false;
        musicToggle.textContent = "üîá Music";
      }
    }catch(e){}
  });

  // ---------- Screen 0 ----------
  const coldContinue = $("coldContinue");
  async function runColdOpen(){
    await type($("cold1"), "Shantanu‚Ä¶ where the hell is my husband? üíç");
    await sleep(PAUSE);
    await type($("cold2"), "What is taking him so long to find meee meee meee?");
    await sleep(PAUSE);
    $("cold3").textContent =
      "System scan initiated‚Ä¶\n" +
      "Searching nearby‚Ä¶\n" +
      "Husband not found.\n" +
      "Long-term boyfriend detected: 12 years (persistent, adorable, slightly delayed).\n" +
      "Primary user: Dhruva (tired of ‚Äúsoon‚Äù).";
    coldContinue.classList.remove("hidden");
  }

  coldContinue.addEventListener("click", async () => {
    startMusic();
    show("s1");
    await runRenewal();
  });

  // ---------- Screen 1 ----------
  const toAudit = $("toAudit");
  async function runRenewal(){
    await type($("h1"), "Annual Boyfriend Membership Renewal üìÑ", 14);
    await sleep(200);
    $("p1").textContent =
      "Welcome, Shantanu. Your subscription is up for renewal.\n" +
      "Please submit your application for the Husband Upgrade‚Ñ¢ (requested by Dhruva).";

    $("list1").innerHTML = [
      "<li><b>Relationship duration:</b> 12 years</li>",
      "<li>Status: ‚ÄúBoyfriend (long-term, high potential)‚Äù</li>",
      "<li><b>Ring integration:</b> Not detected üíç‚ùå</li>",
      "<li>Excuse database: robust</li>",
      "<li>Soft skills: elite (unfortunately adorable)</li>"
    ].join("");

    $("terms").textContent =
      "By continuing, you acknowledge that:\n" +
      "1) you will stop saying ‚Äúsoon‚Äù,\n" +
      "2) you will accept acts of service without acting tough,\n" +
      "3) you will enter princess mode for one (1) night.";

    $("hint1").textContent = "Proceed only after reading. Slowly. Like you do.";
    toAudit.classList.remove("hidden");
  }

  toAudit.addEventListener("click", async () => {
    show("s2");
    await runAudit();
  });

  // ---------- Screen 2 (slower audit) ----------
  const toFinal = $("toFinal");
  let score = 100;
  function setScore(n){
    score = Math.max(0, Math.min(100, n));
    $("score").textContent = score;
  }

  async function runAudit(){
    await type($("h2"), "Evaluating Eligibility‚Ä¶ üß†üíç", 14);
    await sleep(200);
    $("p2").textContent =
      "Please hold. Running diagnostics on Shantanu‚Äôs ‚Äúhusband energy.‚Äù\n" +
      "(This is a safe space. Mostly.)";

    setScore(100);
    $("badge").textContent = "Evaluating";
    $("scoreNote").textContent = "Starting at 100. Deductions may apply (they will).";
    $("auditHint").textContent = "Read each line. Don‚Äôt skim. This is personalized trauma.";
    $("deduct").innerHTML = "<li>‚Äî audit started ‚Äî</li>";
    $("log").textContent = "Initializing‚Ä¶";
    $("bar").style.width = "0%";
    $("warn").textContent = "CRITICAL DELAY IN PROPOSAL PIPELINE";

    const steps = [
      {p:12,  title:"Scanning for husband energy‚Ä¶",     line:"-12: Has not been with Dhruva 24√ó7 this year (reduces score).", delta:12},
      {p:28,  title:"Checking proactive romance‚Ä¶",      line:"-15: Did not proactively over-compensate after 100 fights without being asked.", delta:15},
      {p:44,  title:"Public dominance display check‚Ä¶",  line:"-20: Has not shown the world Dhruva dominates you equally (or more).", delta:20},
      {p:60,  title:"Excuse engine performance test‚Ä¶",  line:"-18: Excuse generation speed = HIGH for everything.", delta:18},
      {p:78,  title:"Connecting to Ring API‚Ä¶",          line:"-25: Another year with NO RING detected. üíç‚ùå", delta:25},
      {p:90,  title:"Counter-checking love & loyalty‚Ä¶", line:"+10: Emotional compatibility = elite. Cuddle compliance = dangerously high.", delta:-10},
      {p:100, title:"Verdict compiling‚Ä¶",               line:"Result: Upgrade eligible (barely). Mandatory princess mode tonight.", delta:0},
    ];

    const list = [];
    for (let i=0;i<steps.length;i++){
      const s = steps[i];
      $("bar").style.width = s.p + "%";
      $("log").textContent = s.title + "\n" + s.line;

      if (s.delta > 0) setScore(score - s.delta);
      if (s.delta < 0) setScore(score + Math.abs(s.delta));

      list.push(s.line);
      $("deduct").innerHTML = list.map(x=>`<li>${x}</li>`).join("");

      if (i === 4) $("warn").textContent = "WARNING: Proposal firmware outdated";
      if (i === 5) $("warn").textContent = "NOTICE: Tonight‚Äôs plan will be handled by Dhruva üòå";

      // Slow it down for him:
      await sleep(1800); // make 2400 if you want EVEN slower
    }

    $("badge").textContent = "Approved (pending obedience)";
    $("scoreNote").textContent = "Proceed when you have processed your feelings.";
    toFinal.classList.remove("hidden");
  }

  toFinal.addEventListener("click", async () => {
    show("s3");
    await runFinalText();
  });

  // ---------- Screen 3 ----------
  async function runFinalText(){
    await type($("h3"), "Final Confirmation üòå", 14);
    await sleep(250);
    $("p3").textContent =
      "Shantanu, do you accept this stay-in anniversary date tonight?\n" +
      "Dhruva has planned everything. Your only job is to show up and be loved.";
  }

  // NO button dodge (so he eventually says yes)
  const noBtn = $("no");
  const yesBtn = $("yes");
  let dodgeCount = 0;

  function clamp(n,min,max){ return Math.max(min, Math.min(max, n)); }
  window.addEventListener("mousemove", (e)=> window.__last = {x:e.clientX,y:e.clientY}, {passive:true});
  window.addEventListener("touchstart", (e)=>{
    const t=e.touches[0]; if(t) window.__last={x:t.clientX,y:t.clientY};
  }, {passive:true});

  function moveNo(){
    dodgeCount++;
    const wrap = document.querySelector(".wrap").getBoundingClientRect();
    const card = $("card").getBoundingClientRect();
    const n = noBtn.getBoundingClientRect();
    const pad = 16;

    if (!noBtn.dataset.abs){
      noBtn.dataset.abs = "1";
      noBtn.style.position = "absolute";
      noBtn.style.left = (n.left - wrap.left) + "px";
      noBtn.style.top  = (n.top  - wrap.top)  + "px";
    }

    const minX = (card.left - wrap.left) + pad;
    const maxX = (card.right - wrap.left) - n.width - pad;
    const minY = (card.top - wrap.top) + 220;
    const maxY = (card.bottom - wrap.top) - n.height - pad;

    const last = window.__last || {x: card.left + card.width/2, y: card.top + card.height/2};
    const targetX = clamp((last.x - wrap.left) + (Math.random()>0.5 ? 220 : -220), minX, maxX);
    const targetY = clamp((last.y - wrap.top)  + (Math.random()>0.5 ? 140 : -140), minY, maxY);

    noBtn.style.left = clamp(targetX + (Math.random()*120-60), minX, maxX) + "px";
    noBtn.style.top  = clamp(targetY + (Math.random()*100-50), minY, maxY) + "px";

    const lines = [
      "No is currently out of network.",
      "No requires prior authorization.",
      "No has been denied by Dhruva.",
      "Shantanu‚Ä¶ read the page. Stop running.",
      "Ring API still not responding‚Ä¶ interesting."
    ];
    $("footer").textContent = lines[(dodgeCount-1) % lines.length];
    yesBtn.style.transform = `scale(${Math.min(1.18, 1 + dodgeCount*0.02)})`;
  }

  noBtn.addEventListener("mouseenter", moveNo);
  noBtn.addEventListener("mousedown", (e)=>{ e.preventDefault(); moveNo(); });
  noBtn.addEventListener("touchstart", (e)=>{ e.preventDefault(); moveNo(); }, {passive:false});

  yesBtn.addEventListener("click", () => {
    show("s4");
  });

  // Start
  runColdOpen().catch(() => {
    // fallback if typewriter fails
    $("cold1").textContent = "Shantanu‚Ä¶ where the hell is my husband? üíç";
    $("cold2").textContent = "What is taking him so long to find meee meee meee?";
    $("cold3").textContent =
      "System scan initiated‚Ä¶\nSearching nearby‚Ä¶\nHusband not found.\nLong-term boyfriend detected: 12 years.\nPrimary user: Dhruva.";
    coldContinue.classList.remove("hidden");
  });
});
</script>
</body>
</html>
